# LogicBench テスト実行 日報（2025-10-08）

## 📅 日付
2025年10月8日（水）

---

## 🧩 作業内容

1. **テストデータ整形**  
   - `data/dev_20.jsonl` が1行に複数JSON連結されていたため、正規表現で整形し  
     → `data/dev_20_fixed.jsonl`（1行＝1問）を作成。  
   - `data/gold_20.jsonl` と `id` の整合性を確認（`rebuild:001`〜`020`形式で一致）。

2. **推論実行**  
   - モデル：`gpt-4o-mini`  
   - スクリプト：`scripts/eval_runner_lenient.py`  
   - 対象：20問（`data/dev_20_fixed.jsonl`）  
   - 出力：`runs/pred_20251008.jsonl`

3. **採点・コスト算出**  
   - スクリプト：`scripts/score_and_cost_simple.py`  
   - gold：`data/gold_20.jsonl`  
   - 出力：`reports/summary_20251008.csv`  
   - 単価：入力 $0.00015 /1K tok、出力 $0.0006 /1K tok（概算）

4. **レポート生成**  
   - スクリプト：`scripts/make_report_simple.py`  
   - 出力：`reports/logicbench_test_report_20251008.md`

---

## 📊 テスト結果サマリー

| 指標 | 値 |
|---|---|
| 総問数 | 20 |
| 正解数 | 12 |
| 正答率 | **0.600** |
| 概算APIコスト | **$0.0002** |
| カテゴリ | 全件 `unknown`（分類未設定） |

### 🔹 精度傾向
- 選択肢問題に対して 60% 正答。  
- 明確な誤りパターンは「出力が `NONE`」「選択肢以外を返す」ケースに集中。  
- 指示が弱いと推論結果が `"A"`・`"D"` に偏る傾向。

---

## 🧠 つまずいた点・対応内容

| つまずき | 対応 |
|---|---|
| `dev_20.jsonl` が複数オブジェクト連結 | 正規表現で改行整形し `data/dev_20_fixed.jsonl` 作成 |
| `o1-mini` でAPI互換エラー（systemロール/Responses非対応） | 一時的に `gpt-4o-mini` へ戻して実行・完了 |
| カテゴリがすべて `unknown` | dev側に `category` 未付与。次回タグ付け予定 |
| 出力に `NONE` が混入 | 正規化ロジックの補正（空文字・未出力時処理）を次回対応 |

---

## 💡 次回以降の改善計画

1. **モデル選定再検討**  
   - `o1-mini` 利用可否の再確認（Responses APIでの正式サポート要件確認）。  
   - 必要に応じて `gpt-4o` / `gpt-4-turbo` で再評価。

2. **カテゴリ付与**  
   - `dev_20_fixed.jsonl` に `category` を追加（例：`math` / `logic` / `language`）。

3. **正規化の強化**  
   - `NONE` 防止、`Answer:` 抽出の厳密化、単一文字回答の強制など。

4. **レポート改善**  
   - ミスケース上位の自動抽出、精度分布（ヒストグラム）などの可視化追加。

---

## ✅ 成果まとめ

- 20問の推論・採点・コスト算出を完了。  
- 初期正答率：**60%**。  
- スクリプト一式（推論・採点・レポート）が動作確認済み。  
- APIエラーの原因切り分け完了（`o1-mini` 非対応によるもの）。

---

## 🗂 生成物

- `data/dev_20_fixed.jsonl`（整形済み入力）  
- `runs/pred_20251008.jsonl`（推論結果）  
- `reports/summary_20251008.csv`（採点＆コスト明細）  
- `reports/logicbench_test_report_20251008.md`（テストレポート）

---

### 提出メモ
Git で提出する場合：
```bash
git add reports/logicbench_daily_20251008.md
git commit -m "report: daily test summary (acc=0.60, model=gpt-4o-mini)"
git push
